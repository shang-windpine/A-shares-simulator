### 首先明确一个大前提： 一个股票的价格波动，或者说是当前定价，是由供需买卖决定的。所以，在我们的系统中，不需要去模拟价格波动生产股票价格数据，只需要创建大量的模拟股票委托单，通过订单系统和撮合系统的结合，就可以生成实时的定价。

#### order_engine: 同时维护Redis 和 Mysql 的股票订单池

1. 想象一个redis数据库中包含了大量的订单数据，而order_engine 则负责了这些订单的创建，创建前的校验，撤单。
对于Redis 来说，要求的是高速变化，所以这里订单创建即增加数据，撤单即删除数据, 已成交的订单也会从redis中消失。

而对于Mysql 来说，要做到尽可能的记录详细的数据。所以撤单仅仅是修改订单的状态而不是删除数据。

2. order_engine 还需要对外提供针对订单的CRUD 接口（Redis 和 mysql）

#### 可以想象order_engine 维护了订单的持久化，而match_engine 撮合引擎 则产生了订单的变化从而导致行情的变化。

#### match_engine: 维护了每个股票的实时订单薄，同时按照规则计算撮合成交

1. 需要不断（目前暂时设定为每秒）刷新全部股票的订单薄，一个订单薄的视图应该为
    - 买卖5档价格和对应价格的委托总手数
    - 每一档价格的委托订单队列，按时间先后排序
2. 默认情况下，订单薄上订单都是被动买卖单，那么我们需要有一种机制去检测到主动买卖单进入到新的订单池中（可以由order_engine notify也可以由自身刷新检测前后差异），这样才能够撮合成交。
3. 成交后，需要把订单的状态变更情况通过order_engine提供的接口，应用到对应的持久化数据中（mysql和redis）。